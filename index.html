<!DOCTYPE html>
  <html lang="en">
  <head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css">
    <link rel="stylesheet" href="style.css">
    <script src="https://kit.fontawesome.com/d451d1e88b.js" crossorigin="anonymous"></script>
  </head>
  <body>
    <div class="align-items-center justify-content-center" id="loading" style="position:absolute; height: 100vh; width: 100vw;">
      <svg version="1.1" id="L4" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"
        viewBox="0 0 100 100" enable-background="new 0 0 0 0" xml:space="preserve">
        <circle fill="#fff" stroke="none" cx="6" cy="50" r="6">
          <animate
            attributeName="opacity"
            dur="1s"
            values="0;1;0"
            repeatCount="indefinite"
            begin="0.1"/>    
        </circle>
        <circle fill="#fff" stroke="none" cx="26" cy="50" r="6">
          <animate
            attributeName="opacity"
            dur="1s"
            values="0;1;0"
            repeatCount="indefinite" 
            begin="0.2"/>       
        </circle>
        <circle fill="#fff" stroke="none" cx="46" cy="50" r="6">
          <animate
            attributeName="opacity"
            dur="1s"
            values="0;1;0"
            repeatCount="indefinite" 
            begin="0.3"/>     
        </circle>
      </svg> 
    </div>
    <div class="container-fluid my-4">
      <div class="row">
        <div class="col h3">Color Search</div>
        <div class="col ms-auto">
            <input autocomplete="off" id="search_color" type="text" placeholder="What color are we looking for ?">
            <div id="search_submit"></div>
        </div>
      </div>
    </div>
    <div class="container-fluid mb-5">
      <div id="colors_list" class="row row-cols-2 row-cols-md-4 g-4"></div>
    </div>
      
    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
        <symbol xmlns="http://www.w3.org/2000/svg" viewBox="0 0 160 28" id="path">
            <path d="M32.9418651,-20.6880772 C37.9418651,-20.6880772 40.9418651,-16.6880772 40.9418651,-12.6880772 C40.9418651,-8.68807717 37.9418651,-4.68807717 32.9418651,-4.68807717 C27.9418651,-4.68807717 24.9418651,-8.68807717 24.9418651,-12.6880772 C24.9418651,-16.6880772 27.9418651,-20.6880772 32.9418651,-20.6880772 L32.9418651,-29.870624 C32.9418651,-30.3676803 33.3448089,-30.770624 33.8418651,-30.770624 C34.08056,-30.770624 34.3094785,-30.6758029 34.4782612,-30.5070201 L141.371843,76.386562" transform="translate(83.156854, 22.171573) rotate(-225.000000) translate(-83.156854, -22.171573)"></path>
        </symbol>
    </svg>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        // Get variable names
        let search_input = document.getElementById('search_color');
        let colors_list = document.getElementById('colors_list');
        let loading_animation = document.getElementById('loading');

        // Fetch data from API
        async function fetchColors(){
          loading_animation.style.display = "flex";
          const response = await fetch("https://api.sampleapis.com/csscolornames/colors");
          loading_animation.style.display = "none";
          return await response.json();
        }

        // Show on loading
        showRandomColors(20);

        // Show on typing search input
        search_input.addEventListener("keyup", ()=>{
          colors_list.innerHTML='';
          if(search_input.value.length>2){
            showSelectedColors(search_input.value);
          }
          if(search_input.value.length===0){
            showRandomColors(20);
          }
        })


        // general functions rendering data
        function getRandomArrayFromData(data, count){
          let random_array=[];
          while(random_array.length<count){
            random_array.push(data[Math.floor(Math.random() * data.length-1)]);
          }
          return random_array;
        }

        function showRandomColors(count){
          colors_list.innerHTML='';
          fetchColors()
            .then(data=>{
              getRandomArrayFromData(data, count).forEach(element => {
                colors_list.innerHTML+=`<div class="col">
                                  <div class="card h-100 border-0 p-0 shadow" style="background-color:${element.hex}">
                                    <div class="card-body rounded-top" style="max-height: 100px; background-color:${element.hex}">
                                      <div class="fs-5"></div>
                                      <small class="text-muted"></small>
                                    </div>
                                    <div class="card-footer" style="background-color:white; height:inherit">
                                      <div class="fs-5">${element.name}</div>
                                      <div class="text-muted">${element.hex}</div>
                                    </div>
                                  </div>
                                </div>`;
              });
            })
            .catch(err=>console.log(err));
        }


        function getFilteredArrayFromData(data, input_value){
            return data.filter(val=>{
                    if(val.name.includes(input_value)){
                      return val;
                    }
                  });
            // let color_names_arr=data.map(val=>val.name);
            // let filtered_arr = color_names_arr.filter((str)=>str.indexOf(input_value) === 0);
            // let filtered_arr = color_names_arr.filter(str=>str.includes(input_value));
        }

        function showSelectedColors(input_value){
          fetchColors()
            .then(data=>{
              getFilteredArrayFromData(data, input_value).forEach(element => {
                colors_list.innerHTML+=`<div class="col">
                                  <div class="card h-100 border-0 p-0 shadow" style="background-color:${element.hex}">
                                    <div class="card-body rounded-top" style="background-color:${element.hex}">
                                      <div class="fs-5"></div>
                                      <small class="text-muted"></small>
                                    </div>
                                    <div class="card-footer" style="background-color:white; height:inherit">
                                      <div class="fs-5">${element.name}</div>
                                      <div class="text-muted">${element.hex}</div>
                                    </div>
                                  </div>
                                </div>`;
              });
            })
            .catch(err=>console.log(err));
        }

    </script>
</body>
</html>